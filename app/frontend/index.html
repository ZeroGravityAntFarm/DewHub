<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-+0n0xVW2eSR5OomGNYDnhzAbDsOXxcvSN1TPprVMTNDbiYZCxYbOOl7+AMvyTG2x" crossorigin="anonymous">

    <title>Dewrito Share</title>

    <!-- <link href="index.css" rel="stylesheet"> -->
  </head>
  <body>
    <div class="bg"></div>
    
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container-fluid">
          <a class="navbar-brand" href="#">Dewrito Share</a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarScroll" aria-controls="navbarScroll" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>
          <form class="d-flex">
            <input class="form-control me-2" type="search" placeholder="Search" aria-label="Search">
            <button class="btn btn-outline-success" type="submit">Search</button>
          </form>
          <div class="collapse navbar-collapse" id="navbarScroll">
            <ul class="navbar-nav me-auto my-2 my-lg-0 navbar-nav-scroll" style="--bs-scroll-height: 100px;">
            </ul>
            <form class="d-flex">
              <button class="btn btn-outline-primary me-1" type="submit">Login</button>
              <button class="btn btn-outline-primary me-1" type="submit">Sign Up</button>
            </form>
          </div>
        </div>
      </nav>

      <div id="map-container" class="container">
        <div class="row">
          <div id="map-cards"></div>
        </div>
      </div>

    <script src="index.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.0.16/dist/sweetalert2.all.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-gtEjrD/SeCtmISkJkNUaaKMoLD0//ElJ19smozuHV6z3Iehds+3Ulb9Bn9Plx0x4" crossorigin="anonymous"></script>
  </body>
</html>

<script>

function loadCards() {
  const xhttp = new XMLHttpRequest();
  xhttp.open("GET", "http://localhost:8001/api_v1/maps");
  xhttp.send();
  xhttp.onreadystatechange = function() {
    if (this.readyState == 4 && this.status == 200) {
      console.log(this.responseText);
      var trHTML = ''; 
      const objects = JSON.parse(this.responseText);
      for (let [i, object] of objects.entries()) {
        
        if (i % 3 === 0){
            trHTML += '</div>';
            trHTML += '<div class="row top-buffer">';
          }

        trHTML += '<div class="col mb-3 mt-4">';
        trHTML += '<div class="card text-white bg-dark" >';
        trHTML += '<img src="guardian.jpg" class="card-img-top" alt="...">';
        trHTML += '<div class="card-body">';
        trHTML += '<h4 class="card-title">'+object['mapName']+'</h4>';
        trHTML += '<h5 class="card-title">Author: '+object['mapAuthor']+'</h5>';
        trHTML += '</div>';
        trHTML += '<p class="card-text p-3">'+object['mapDescription']+'</p>';
        trHTML += '</ul>';
        trHTML += '<div class="d-grid gap-2 d-md-block p-3">';
        trHTML += '<a href="http://localhost:8001/api_v1/maps/'+object['mapName']+'/file" class="btn btn-primary me-1">Map File</a>';
        trHTML += '<a href="http://localhost:8001/api_v1/maps/'+object['mapName']+'/variant/file" class="btn btn-primary me-1">Variant File</a>';
        trHTML += '</div>'
        trHTML += '<div class="card-footer"><small class="text-muted">Downloads: '+object['map_downloads']+'</small></div>';
        trHTML += '</div>';
        trHTML += '</div>';

      }
    }
    document.getElementById("map-cards").innerHTML = trHTML;
  }
};

loadCards();
</script>

<style>  
    body {
        font-size: 1.25rem;
        background-image: url("halo.jpg");
        background-color: #51a8ff;
        background-position: center;
        background-size: cover;
        background-repeat: no-repeat;
        background-attachment: fixed;

    }

    map-container{
        margin-top: 25%;
    }

    td {
        line-height: 3rem;
    }

    .avatar {
        vertical-align: middle;
        width: 100px;
        height: 100px;
        border-radius: 50%;
    }
</style>